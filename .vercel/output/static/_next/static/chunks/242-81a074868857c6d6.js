"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{6262:function(e,t,r){r.d(t,{Q:function(){return v}});var a=r(7437),s=r(2265),n=r(2869),i=r(5186),l=r(6815),o=r(5696),c=r(9322),d=r(1817),u=r(9345),f=r(2208),m=r(8730),h=r(4438);let g=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",className:t,"aria-hidden":"true",children:[(0,a.jsx)("path",{fill:"#4285F4",d:"M23.745 12.27c0-.79-.07-1.54-.19-2.27h-11.3v4.51h6.47c-.29 1.48-1.14 2.73-2.4 3.58v2.98h3.9c2.26-2.09 3.52-5.17 3.52-8.8z"}),(0,a.jsx)("path",{fill:"#34A853",d:"M12.255 24c3.24 0 5.95-1.08 7.93-2.91l-3.9-2.98c-1.08.72-2.45 1.16-4.03 1.16-3.09 0-5.71-2.08-6.65-4.9h-4.02v3.08c1.97 3.9 6.03 6.55 10.67 6.55z"}),(0,a.jsx)("path",{fill:"#FBBC05",d:"M5.605 14.37c-.25-.72-.38-1.48-.38-2.27s.14-1.55.38-2.27v-3.08h-4.02c-.82 1.62-1.29 3.44-1.29 5.35s.47 3.73 1.3 5.35l3.99-3.08z"}),(0,a.jsx)("path",{fill:"#EA4335",d:"M12.255 4.73c1.7 0 3.22.59 4.43 1.74l3.45-3.45c-2.01-1.86-4.63-3.02-7.88-3.02-4.64 0-8.7 2.65-10.67 6.55l4.02 3.08c.94-2.81 3.56-4.9 6.65-4.9z"})]})};var p=r(8706),x=r(7148);function v(e){let{open:t,onOpenChange:r}=e,v=(0,p.T_)("auth"),[y,w]=(0,s.useState)(""),[b,N]=(0,s.useState)(""),[j,k]=(0,s.useState)(!1),[C,_]=(0,s.useState)(!1),[E,I]=(0,s.useState)(null),[S,A]=(0,s.useState)(!1),[z,Z]=(0,s.useState)(!1),[U,P]=(0,s.useState)(!1),{signInWithGoogle:F,signInWithEmail:T,signUpWithEmail:R,resetPassword:O}=(0,m.a)(),[D,J]=(0,s.useState)(null),V=async()=>{_(!0),I(null);try{if("function"!=typeof F)throw Error(v("signInNotInitialized"));await F(),(0,x.QU)("google");let e=new CustomEvent("loginSuccess");window.dispatchEvent(e)}catch(e){console.error("Google sign in error:",e),I(e instanceof Error?e.message:v("generalError")),h.A.error(v("signInFailed")),_(!1)}},G=async()=>{if(y&&b){k(!0),I(null);try{await T(y,b),(0,x.QU)("email"),h.A.success(v("signInSuccess")),r(!1);let e=new CustomEvent("loginSuccess");window.dispatchEvent(e)}catch(e){console.error("Email sign in error:",e),I(e instanceof Error?e.message:v("signInError"))}finally{k(!1)}}},B=async()=>{if(y&&b){J(null),k(!0),I(null);try{await R(y,b),(0,x.r)("email"),h.A.success(v("signUpSuccess")),r(!1);let e=new CustomEvent("loginSuccess");window.dispatchEvent(e)}catch(e){console.error("Email sign up error:",e),I(e instanceof Error?e.message:v("signUpError"))}finally{k(!1)}}},q=async()=>{if(y){k(!0),I(null);try{await O(y),h.A.success(v("resetPasswordSuccess")),Z(!1)}catch(e){console.error("Password reset error:",e),I(e instanceof Error?e.message:v("resetPasswordError"))}finally{k(!1)}}};return z?(0,a.jsx)(o.Vq,{open:t,onOpenChange:r,children:(0,a.jsx)(o.cZ,{className:"sm:max-w-md p-0 overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)(o.fK,{className:"text-center mb-4",children:[(0,a.jsx)(o.$N,{className:"text-2xl font-bold",children:v("resetPassword")}),(0,a.jsx)(o.Be,{className:"text-muted-foreground",children:v("resetPasswordDescription")})]}),E&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-4 text-sm bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-800 rounded-md text-red-600 dark:text-red-400",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:E})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"email-reset",children:v("email")}),(0,a.jsx)(i.I,{id:"email-reset",type:"email",placeholder:v("enterYourEmail"),value:y,onChange:e=>w(e.target.value),className:"h-12 rounded-md"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(n.z,{onClick:()=>Z(!1),variant:"outline",className:"w-1/2 h-12",disabled:j,children:v("back")}),(0,a.jsxs)(n.z,{onClick:q,disabled:j||!y,className:"w-1/2 h-12",children:[j?(0,a.jsx)(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),v("sendResetEmail")]})]})]})]})})}):(0,a.jsx)(o.Vq,{open:t,onOpenChange:r,children:(0,a.jsx)(o.cZ,{className:"sm:max-w-md p-0 overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)(o.fK,{className:"text-center mb-4",children:[(0,a.jsx)(o.$N,{className:"text-2xl font-bold text-center",children:S?v("signUpTitle"):v("signInTitle")}),(0,a.jsx)(o.Be,{className:"text-muted-foreground text-center",children:S?v("signUpDescription"):v("signInDescription")})]}),E&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-4 text-sm bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-800 rounded-md text-red-600 dark:text-red-400",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:E})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"email",children:v("email")}),(0,a.jsx)(i.I,{id:"email",type:"email",placeholder:v("emailPlaceholder"),value:y,onChange:e=>{w(e.target.value),J(null)},className:"h-12 rounded-md"}),S&&D&&(0,a.jsx)("div",{className:"text-xs text-red-500 mt-1",children:D})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)(l._,{htmlFor:"password",children:v("password")})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.I,{id:"password",type:U?"text":"password",placeholder:v("passwordPlaceholder"),value:b,onChange:e=>N(e.target.value),className:"h-12 rounded-md pr-10"}),(0,a.jsx)("button",{type:"button",onClick:()=>P(!U),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(f.Z,{className:"h-5 w-5"})})]})]}),(0,a.jsxs)(n.z,{onClick:S?B:G,disabled:C||!y||!b||S&&!!D,className:"w-full h-12",children:[j?(0,a.jsx)(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,S?v("signUp"):v("signIn")]}),!S&&(0,a.jsx)("div",{className:"flex justify-start mt-2",children:(0,a.jsx)("button",{type:"button",onClick:()=>Z(!0),className:"text-xs text-primary hover:text-blue-800 hover:underline dark:text-blue-400 dark:hover:text-blue-300",children:v("forgotPassword")})}),(0,a.jsxs)("div",{className:"relative my-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,a.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-700"})}),(0,a.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,a.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:v("or")})})]}),(0,a.jsxs)(n.z,{onClick:V,disabled:j,className:"w-full h-12 bg-white hover:bg-gray-50 text-gray-900 border border-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-white dark:border-gray-600",variant:"outline",children:[C?(0,a.jsx)(d.Z,{className:"h-5 w-5 animate-spin mr-2"}):(0,a.jsx)(g,{className:"h-5 w-5 mr-2"}),C?v("signingIn"):v("continueWithGoogle")]}),(0,a.jsx)("div",{className:"text-center mt-4",children:(0,a.jsx)("button",{type:"button",onClick:()=>A(!S),className:"text-sm text-primary hover:text-primary/80",children:S?v("alreadyHaveAccount"):v("dontHaveAccount")})})]}),(0,a.jsx)("div",{className:"text-center text-xs text-muted-foreground mt-6",children:"By continuing, you agree to our Terms of Service and Privacy Policy"})]})})})}},6831:function(e,t,r){r.d(t,{F$:function(){return o},Q5:function(){return c},qE:function(){return l}});var a=r(7437),s=r(2265),n=r(4930),i=r(4508);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s})});l.displayName=n.fC.displayName;let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.Ee,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",r),...s})});o.displayName=n.Ee.displayName;let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.NY,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s})});c.displayName=n.NY.displayName},2869:function(e,t,r){r.d(t,{z:function(){return c}});var a=r(7437),s=r(2265),n=r(8482),i=r(7712),l=r(4508);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:s,size:i,className:r})),ref:t,...d})});c.displayName="Button"},5696:function(e,t,r){r.d(t,{$N:function(){return p},Be:function(){return x},GG:function(){return u},Vq:function(){return o},cN:function(){return g},cZ:function(){return m},fK:function(){return h},hg:function(){return c}});var a=r(7437),s=r(2265),n=r(1833),i=r(2489),l=r(4508);let o=n.fC,c=n.xz,d=n.h_,u=n.x8,f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s})});f.displayName=n.aV.displayName;let m=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(f,{}),(0,a.jsxs)(n.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...o,children:[s,(0,a.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 transition-all duration-200 hover:opacity-100 hover:bg-accent/50 hover:text-accent-foreground focus:outline-none focus:opacity-100 focus:bg-accent/50 disabled:pointer-events-none p-1",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.VY.displayName;let h=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};h.displayName="DialogHeader";let g=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};g.displayName="DialogFooter";let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});p.displayName=n.Dx.displayName;let x=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...s})});x.displayName=n.dk.displayName},5186:function(e,t,r){r.d(t,{I:function(){return i}});var a=r(7437),s=r(2265),n=r(4508);let i=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});i.displayName="Input"},6815:function(e,t,r){r.d(t,{_:function(){return c}});var a=r(7437),s=r(2265),n=r(370),i=r(7712),l=r(4508);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,l.cn)(o(),r),...s})});c.displayName=n.f.displayName},8730:function(e,t,r){r.d(t,{AuthProvider:function(){return o},a:function(){return c}});var a=r(7437),s=r(2265),n=r(2141),i=r(1121);let l=(0,s.createContext)(void 0);function o(e){var t;let{children:r}=e,[o,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),f=(0,n.J)(),m=async e=>{try{var t;if(!(null===(t=e.user_metadata)||void 0===t?void 0:t.display_name)){let t=(0,i.f6)(e);await (0,i.yf)(e,t)}}catch(e){console.error("Failed to save user display name:",e)}},h=(0,s.useCallback)(async()=>{try{let{data:{user:e},error:t}=await f.auth.getUser();if(t){"Auth session missing!"!==t.message&&console.error("Error refreshing user:",t);return}c(e)}catch(e){e instanceof Error&&"Auth session missing!"!==e.message&&console.error("Failed to refresh user:",e)}},[f.auth]),g=(0,s.useCallback)(async(e,t)=>{try{(null==t?void 0:t.user)?(c(t.user),await m(t.user),setTimeout(async()=>{try{let{data:{user:e}}=await f.auth.getUser();e&&c(e)}catch(e){console.error("Error getting latest user:",e)}},500)):c(null)}catch(e){console.error("Error in auth state change:",e),c(null)}u(!1)},[f.auth]);(0,s.useEffect)(()=>{let e=!0,t=async()=>{try{let{data:{user:t},error:r}=await f.auth.getUser();if(r){"Auth session missing!"!==r.message&&console.error("Error getting user:",r),c(null),u(!1);return}if(e){if(t){c(t),await m(t);let{data:{user:r}}=await f.auth.getUser();r&&e&&c(r)}u(!1)}}catch(t){t instanceof Error&&"Auth session missing!"!==t.message&&console.error("Failed to initialize auth:",t),e&&(c(null),u(!1))}},{data:{subscription:r}}=f.auth.onAuthStateChange(g);return t(),()=>{e=!1,r.unsubscribe()}},[f.auth,g]);let p=async(e,t)=>{let{data:r,error:a}=await f.auth.signUp({email:e,password:t,options:{data:{role:"user"}}});return{data:r,error:a}},x=async(e,t)=>{let{data:r,error:a}=await f.auth.signInWithPassword({email:e,password:t});return{data:r,error:a}},v=async()=>{let{error:e}=await f.auth.signOut();if(e)throw e},y=async()=>{let{error:e}=await f.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e},w=async(e,t)=>{let{error:r}=await f.auth.signInWithPassword({email:e,password:t});if(r)throw r},b=async(e,t)=>{let{error:r}=await f.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback"),data:{role:"user"}}});if(r)throw r},N=async e=>{let{error:t}=await f.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});if(t)throw t},j=(null==o?void 0:null===(t=o.user_metadata)||void 0===t?void 0:t.role)==="admin";return(0,a.jsx)(l.Provider,{value:{user:o,loading:d,signUp:p,signIn:x,signOut:v,signInWithGoogle:y,signInWithEmail:w,signUpWithEmail:b,resetPassword:N,isAdmin:j,refreshUser:h},children:r})}function c(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6314:function(e,t,r){r.d(t,{$:function(){return i}});var a=r(2265),s=r(8730);let n=(0,r(3011).U)(e=>({credits:null,canGenerate:!1,setCredits:t=>e({credits:t}),setCanGenerate:t=>e({canGenerate:t}),updateCredits:t=>e(e=>{if(!e.credits)return e;let r={...e.credits,credits:e.credits.credits-t,total_spent:e.credits.total_spent+t};return{credits:r,canGenerate:r.credits>=1}})}));function i(){let{user:e,isAdmin:t}=(0,s.a)(),[r,i]=(0,a.useState)(!0),[l,o]=(0,a.useState)(null),{credits:c,canGenerate:d,setCredits:u,setCanGenerate:f,updateCredits:m}=n(),h=(0,a.useCallback)(async()=>{if(null==e?void 0:e.id)try{i(!0),o(null);let r=await fetch("".concat("","/api/user-usage?userId=").concat(e.id,"&isAdmin=").concat(t));if(!r.ok)throw Error("HTTP ".concat(r.status,": ").concat(r.statusText));let a=await r.json();a.success?(u(a.data.credits),f(a.data.canGenerate)):a.setup_required?(o("配置错误: ".concat(a.details)),console.error("\uD83D\uDD27 Database setup required:",a.details)):o(a.error||"Failed to fetch credits")}catch(e){o("Network error"),console.error("Error fetching credits:",e)}finally{i(!1)}},[null==e?void 0:e.id,t,"",u,f]),g=(0,a.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!(null==e?void 0:e.id))return!1;try{let r=await fetch("".concat("","/api/user-usage"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,action:"spend",amount:t})}),a=await r.json();if(a.success)return u(a.data.credits),f(a.data.credits.credits>=1),!0;return o(a.error||"Failed to spend credits"),!1}catch(e){return o("Network error"),console.error("Error spending credits:",e),!1}},[null==e?void 0:e.id,"",u,f]),p=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;m(e)},[m]);return(0,a.useEffect)(()=>{(null==e?void 0:e.id)?h():(u(null),f(!1))},[null==e?void 0:e.id,h,u,f]),{credits:c,canGenerate:!!t||d,loading:r,error:l,spendCredits:g,updateCreditsLocally:p,isLoggedIn:!!(null==e?void 0:e.id)}}},7148:function(e,t,r){r.d(t,{LV:function(){return a},QU:function(){return l},ZO:function(){return o},r:function(){return i},sH:function(){return n}});let a=e=>{window.gtag&&window.gtag("config","G-NYQTCQWRZ7",{page_location:e})},s=e=>{let{action:t,category:r,label:a,value:s}=e;window.gtag&&window.gtag("event",t,{event_category:r,event_label:a,value:s})},n=(e,t)=>{s({action:"generate_recipe",category:"recipe",label:e,value:t})},i=e=>{s({action:"sign_up",category:"engagement",label:e})},l=e=>{s({action:"login",category:"engagement",label:e})},o=e=>{s({action:"feature_usage",category:"engagement",label:e})}},2141:function(e,t,r){r.d(t,{J:function(){return l}});var a=r(6580),s=r(5452);let n="https://dgjrrwviswykejihagnn.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRnanJyd3Zpc3d5a2VqaWhhZ25uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2NjMzNjEsImV4cCI6MjA2ODIzOTM2MX0.65ZssanZBvAr8kyHAo8IAVW9IjeLUiJZ4qPkFO6OHtI";n&&i||console.error("缺少Supabase环境变量，请检查.env.local文件"),(0,a.eI)(n,i,{auth:{autoRefreshToken:!0,persistSession:!0}});let l=()=>{try{return(0,s.createClientComponentClient)()}catch(e){throw console.error("创建Supabase客户端失败:",e),e}}},4508:function(e,t,r){r.d(t,{cn:function(){return n}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},1121:function(e,t,r){r.d(t,{By:function(){return c},b3:function(){return s},f6:function(){return i},yf:function(){return n}});var a=r(2141);function s(e){var t,r,a;return e?(null===(t=e.user_metadata)||void 0===t?void 0:t.display_name)?e.user_metadata.display_name:(null===(r=e.user_metadata)||void 0===r?void 0:r.full_name)?e.user_metadata.full_name:(null===(a=e.user_metadata)||void 0===a?void 0:a.name)?e.user_metadata.name:e.email?l(e.email):"User":"Guest"}async function n(e,t){if(!e)return!1;try{let e=(0,a.J)(),{data:r,error:s}=await e.auth.updateUser({data:{display_name:t}});if(s)return console.error("Failed to update display name:",s),!1;return!0}catch(e){return console.error("Error updating display name:",e),!1}}function i(e){var t;return e?(null===(t=e.user_metadata)||void 0===t?void 0:t.display_name)?e.user_metadata.display_name:e.email?l(e.email):"User":""}function l(e){let t=e.split("@")[0];return[/\d/,/[._-]/,/^[a-z]+$/,/^[A-Z]+$/,/^[a-zA-Z0-9._-]+$/].some(e=>e.test(t))?function(e){let t=e.replace(/[._-]/g," ").replace(/\d+$/,"").trim();return t?o(t):o(e)}(t):o(t)}function o(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e}function c(e){var t,r;return e&&((null===(t=e.user_metadata)||void 0===t?void 0:t.avatar_url)||(null===(r=e.user_metadata)||void 0===r?void 0:r.picture))||null}}}]);